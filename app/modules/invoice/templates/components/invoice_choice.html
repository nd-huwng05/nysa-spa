<div class="col-lg-7">
    <div class="payment-card p-4 p-md-5">
        <form id="payment-selection-section"
              hx-post="/invoice/create"
              hx-target="#qr-method-container"
              hx-swap="innerHTML transition:true">

            <h2 class="heading-font fs-4 text-heading mb-4">
                <i class="bi bi-wallet2 me-2 text-accent"></i>1. Payment Method
            </h2>

            <input type="hidden" name="booking_code" value="{{booking.booking_code}}">
            <input type="hidden" name="voucher_code" value="{{booking.voucher_usage.code}}">

            <div class="mb-5">
                <label class="fw-bold mb-3 small text-uppercase" style="color: var(--combo-text-subtle)">Transaction
                    Type</label>
                <div class="row g-3">
                    <div class="col-md-6 {%if current_role == 'CUSTOMER'%}disabled{%endif%}">
                        <input type="radio" class="btn-check" name="payment_method" id="cash-option"
                               value="CASH" {% if current_user.role.value == "ABC" %}disabled{% endif %}>
                        <label class="btn btn-outline-combo w-100 py-3 {% if current_role == 'ABC' %}opacity-50{% endif %}"
                               for="cash-option">
                            <i class="bi bi-cash-stack me-2"></i> Cash
                        </label>
                    </div>
                    <div class="col-md-6">
                        <input type="radio" class="btn-check" name="payment_method" id="bank-transfer-option"
                               value="BANK_TRANSFER" checked>
                        <label class="btn btn-outline-combo w-100 py-3" for="bank-transfer-option">
                            <i class="bi bi-bank me-2"></i> Bank
                        </label>
                    </div>
                </div>
            </div>

            <label class="fw-bold mb-3 small text-uppercase" style="color: var(--combo-text-subtle)">Payment
                Option</label>
            <div class="mb-5">
                <label class="payment-type-option" for="full-payment">
                    <input class="form-check-input" type="radio" name="payment_type" id="full-payment" value="FULL"
                           checked>
                    <span class="custom-checkmark"></span>
                    <span class="label-text">Pay Full Amount</span>
                    <span class="amount-display"
                          id="full-amount-display">{{"{:,.0f}".format(variable['total'])}} VND</span>
                </label>

                <label class="payment-type-option" for="deposit-payment">
                    <input class="form-check-input" type="radio" name="payment_type" id="deposit-payment"
                           value="DEPOSIT">
                    <span class="custom-checkmark"></span>
                    <span class="label-text">Deposit ({{variable['deposit_percent']}}%)</span>
                    <span class="amount-display" id="deposit-amount-display">{{"{:,.0f}".format(variable['deposit'])}} VND</span>
                </label>
            </div>

            <button id="confirm-payment-btn" class="btn btn-accent-primary btn-lg w-100 py-3" type="submit">
                <span class="htmx-indicator spinner-border spinner-border-sm me-2"></span>
                PAY NOW ({{"{:,.0f}".format(variable['total'])}} VND)
            </button>
        </form>

        <div id="step-scan-qr" style="display: none;">
            <button type="button" id="back-to-step1" class="btn btn-sm btn-outline-secondary border-0">
                <i class="bi bi-arrow-left me-1"></i> Back
            </button>
                {% include 'components/qrcode.html' %}
                {% include 'components/confirm.html' %}
        </div>
    </div>
</div>