<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Booking & Revenue Dashboard</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    
    <link href="https://cdn.jsdelivr.net/npm/remixicon@3.5.0/fonts/remixicon.css" rel="stylesheet">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#3C50E0', 
                        secondary: '#80CAEE',
                        dark: '#1A222C',
                        body: '#F1F5F9',
                        success: '#10B981', // Màu xanh lá (Hoàn thành)
                        warning: '#F59E0B', // Màu cam (Đang đặt)
                        danger: '#FB5454',  // Màu đỏ (Hủy)
                        graytext: '#64748B'
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    }
                }
            }
        }
    </script>

    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        body { font-family: 'Inter', sans-serif; }
        .chart-tab-active {
            background-color: #3C50E0;
            color: white;
        }
        .chart-tab-inactive {
            background-color: #F1F5F9;
            color: #64748B;
        }
    </style>
</head>
<body class="bg-body text-slate-600">

    <div class="flex h-screen overflow-hidden">
        
        <aside class="w-64 bg-dark text-white hidden lg:flex flex-col">
            <div class="h-20 flex items-center px-6 border-b border-gray-700">
                <div class="flex items-center gap-2">
                    <div class="bg-primary p-1 rounded text-white">
                        <i class="ri-calendar-check-fill text-xl"></i>
                    </div>
                    <span class="text-xl font-bold">BookingAdmin</span>
                </div>
            </div>
            <nav class="flex-1 py-6 px-4 space-y-2">
                <p class="px-2 text-xs font-semibold text-gray-400 uppercase mb-2">Quản lý</p>
                
                <a href="#" class="flex items-center gap-3 px-4 py-3 bg-gray-700 rounded text-white">
                    <i class="ri-dashboard-3-line"></i>
                    <span>Tổng quan</span>
                </a>
                <a href="#" class="flex items-center gap-3 px-4 py-3 text-gray-400 hover:text-white hover:bg-gray-800 rounded transition">
                    <i class="ri-calendar-2-line"></i>
                    <span>Lịch hẹn</span>
                </a>
                <a href="#" class="flex items-center gap-3 px-4 py-3 text-gray-400 hover:text-white hover:bg-gray-800 rounded transition">
                    <i class="ri-money-dollar-circle-line"></i>
                    <span>Báo cáo tài chính</span>
                </a>
                <a href="#" class="flex items-center gap-3 px-4 py-3 text-gray-400 hover:text-white hover:bg-gray-800 rounded transition">
                    <i class="ri-user-settings-line"></i>
                    <span>Nhân viên</span>
                </a>
            </nav>
        </aside>

        <div class="flex-1 flex flex-col overflow-hidden relative">
            
            <header class="h-20 bg-white border-b border-gray-200 flex items-center justify-between px-6 z-10">
                <h2 class="text-xl font-bold text-dark hidden sm:block">Thống kê hoạt động</h2>
                <div class="flex items-center gap-4 ml-auto">
                    <div class="text-right">
                        <p class="text-sm font-semibold text-dark">Admin User</p>
                        <p class="text-xs text-gray-500">Quản lý</p>
                    </div>
                    <div class="w-10 h-10 rounded-full bg-primary text-white flex items-center justify-center font-bold">A</div>
                </div>
            </header>

            {%include 'components/dashboard.html'%}
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
    <script>
        // === CHART 1: REVENUE (Doanh thu) - Có chức năng chuyển Tab ===
        
        // Dữ liệu giả lập
        const revenueData = {
            week: {
                data: [15, 22, 18, 30, 25, 40, 35],
                categories: ['Thứ 2', 'Thứ 3', 'Thứ 4', 'Thứ 5', 'Thứ 6', 'Thứ 7', 'CN']
            },
            month: {
                data: [120, 150, 180, 220],
                categories: ['Tuần 1', 'Tuần 2', 'Tuần 3', 'Tuần 4']
            },
            year: {
                data: [450, 520, 480, 600, 750, 800, 850, 900, 950, 1100, 1050, 1200],
                categories: ['T1', 'T2', 'T3', 'T4', 'T5', 'T6', 'T7', 'T8', 'T9', 'T10', 'T11', 'T12']
            }
        };

        var revenueOptions = {
            series: [{
                name: 'Doanh thu (triệu VNĐ)',
                data: revenueData.week.data // Mặc định là Tuần
            }],
            chart: {
                height: 350,
                type: 'area',
                toolbar: { show: false },
                animations: { enabled: true }
            },
            colors: ['#3C50E0'],
            dataLabels: { enabled: false },
            stroke: { curve: 'smooth', width: 2 },
            xaxis: {
                categories: revenueData.week.categories,
                axisBorder: { show: false },
                axisTicks: { show: false },
            },
            grid: {
                strokeDashArray: 4,
                yaxis: { lines: { show: true } }
            },
            fill: {
                type: 'gradient',
                gradient: { shadeIntensity: 1, opacityFrom: 0.5, opacityTo: 0.05, stops: [0, 90, 100] }
            },
            tooltip: {
                y: { formatter: function (val) { return val + " triệu" } }
            }
        };

        var revenueChart = new ApexCharts(document.querySelector("#revenueChart"), revenueOptions);
        revenueChart.render();

        // Hàm xử lý khi click tab
        function updateRevenue(type) {
            // Cập nhật dữ liệu biểu đồ
            revenueChart.updateOptions({
                xaxis: { categories: revenueData[type].categories }
            });
            revenueChart.updateSeries([{
                data: revenueData[type].data
            }]);

            // Cập nhật style nút bấm (Active/Inactive)
            const buttons = ['btn-week', 'btn-month', 'btn-year'];
            buttons.forEach(btnId => {
                const btn = document.getElementById(btnId);
                if(btnId === 'btn-' + type) {
                    btn.classList.add('chart-tab-active');
                    btn.classList.remove('chart-tab-inactive', 'bg-gray-100', 'text-gray-500');
                } else {
                    btn.classList.remove('chart-tab-active');
                    btn.classList.add('chart-tab-inactive');
                }
            });
        }


        // === CHART 2: STATUS RATIO (Tỷ lệ trạng thái - Donut) ===
        var statusOptions = {
            series: [1024, 128, 15], // Hoàn thành, Đặt, Hủy
            labels: ['Hoàn thành', 'Đang đặt', 'Bị hủy'],
            chart: {
                type: 'donut',
                height: 320,
            },
            colors: ['#10B981', '#3C50E0', '#FB5454'], // Green, Blue, Red
            plotOptions: {
                pie: {
                    donut: {
                        size: '70%',
                        labels: {
                            show: true,
                            total: {
                                show: true,
                                label: 'Tổng lịch',
                                fontSize: '16px',
                                fontWeight: 600,
                                color: '#64748B',
                                formatter: function (w) {
                                    return w.globals.seriesTotals.reduce((a, b) => { return a + b }, 0)
                                }
                            }
                        }
                    }
                }
            },
            legend: { show: false }, // Đã custom legend bên ngoài bằng HTML
            dataLabels: { enabled: false }
        };
        var statusChart = new ApexCharts(document.querySelector("#statusChart"), statusOptions);
        statusChart.render();


        // === CHART 3: PEAK HOURS (Thời gian phổ biến - Bar Chart) ===
        var peakHourOptions = {
            series: [{
                name: 'Số lượt đặt',
                data: [5, 12, 25, 18, 10, 20, 35, 40, 30, 15]
            }],
            chart: {
                type: 'bar',
                height: 300,
                toolbar: { show: false }
            },
            plotOptions: {
                bar: {
                    borderRadius: 4,
                    horizontal: false, // Cột đứng
                    columnWidth: '50%'
                }
            },
            colors: ['#80CAEE'],
            dataLabels: { enabled: false },
            xaxis: {
                categories: ['08:00', '09:00', '10:00', '11:00', '12:00', '13:00', '14:00', '15:00', '16:00', '17:00'],
                title: { text: 'Giờ trong ngày' }
            },
            tooltip: {
                y: { formatter: function (val) { return val + " khách" } }
            }
        };
        var peakHourChart = new ApexCharts(document.querySelector("#peakHourChart"), peakHourOptions);
        peakHourChart.render();


        // === CHART 4: WEEKLY FREQUENCY (Tần suất trong tuần - Line/Area) ===
        var frequencyOptions = {
            series: [{
                name: 'Lượt khách',
                data: [45, 50, 48, 60, 85, 110, 95] // Dữ liệu từ T2 -> CN
            }],
            chart: {
                height: 300,
                type: 'area',
                toolbar: { show: false }
            },
            colors: ['#F59E0B'], // Màu cam cho khác biệt
            stroke: {
                curve: 'smooth',
                width: 3
            },
            xaxis: {
                categories: ['Thứ 2', 'Thứ 3', 'Thứ 4', 'Thứ 5', 'Thứ 6', 'Thứ 7', 'CN']
            },
            grid: {
                borderColor: '#f1f1f1',
            },
            fill: {
                type: 'gradient',
                gradient: {
                    shadeIntensity: 1,
                    opacityFrom: 0.6,
                    opacityTo: 0.1,
                    stops: [0, 90, 100]
                }
            }
        };
        var weeklyChart = new ApexCharts(document.querySelector("#weeklyFrequencyChart"), frequencyOptions);
        weeklyChart.render();

    </script>
</body>
</html>