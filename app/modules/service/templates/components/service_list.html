<div class="row gy-4">
    {%for s in services%}
    <div class="col-xl-4 col-lg-6" data-aos="fade-up" data-aos-delay="200">
        <div class="card service-card h-100 border-0 shadow-sm">
            <div class="service-image position-relative overflow-hidden">
                <img src="{{s.img_url}}" class="card-img-top" alt="{{s.name}}"
                     onerror="this.onerror=null; this.src='https://placehold.co/600x400?text=Nysa+Spa';">
                {%for b in s.service_badges%}
                <span class="badge position-absolute top-0 start-0 m-3 py-2 px-3"
                      style="{{'background-color:' ~b.badge.color_code if b.badge.color_code else 'var(--accent-color)' }}">{{b.badge.name}}</span>
                {%endfor%}
                <div class="price-tag position-absolute bottom-0 end-0 py-2 px-3 text-white fw-bold">
                    {{"{:,.0f}".format(s.price)}} VND<span class="fw-light small">/ {{s.duration_minutes}} min</span>
                </div>
            </div>
            <div class="card-body p-4 d-flex flex-column">
                <h4 class="card-title fw-bold mb-2">{{s.name}}</h4>
                <p class="card-text text-muted mb-4">{{s.short_description}}</p>

                <div class="service-features d-flex gap-3 mb-4 text-muted small">
                    <span><i class="bi bi-clock me-1 text-accent"></i> {{s.duration_minutes}} Mins</span>
                    {%for f in s.features%}
                    <span><i class="{{f.icon}} me-1 text-accent"></i> {{f.name}}</span>
                    {%endfor%}
                </div>

                <div class="mt-auto d-flex gap-2">
                    <a href="#" class="btn btn-outline-accent flex-fill add-to-cart-btn" data-service-id="{{s.id}}">Add
                        cart</a>
                    <a href="/booking/appointment?service={{s.id}}" class="btn btn-accent flex-fill text-white">Book
                        Now</a>
                </div>
            </div>
        </div>
    </div>
    {%endfor%}
</div>

<div class="mt-5" data-aos="fade-up">
    <nav aria-label="Page navigation">
        <ul id="myPagination" class="pagination pagination-scrolling justify-content-center">

            <li class="page-item {% if pagination.page == 1 %}disabled{% endif %}">
                <a class="page-link"
                   href="#" data-page="{{ pagination.page - 1 }}"
                   aria-disabled="{{ 'true' if pagination.page == 1 else 'false' }}">
                    <i class="bi bi-chevron-left"></i> Previous
                </a>
            </li>

            {% for i in range(pagination.total_pages) %}
            {% set p = i + 1 %}

            {% if p == 1 or p == pagination.total_pages or (p >= pagination.page - 2 and p <= pagination.page + 2) %}

            <li class="page-item {% if pagination.page == p %}active{% endif %}">
                <a class="page-link" href="#" data-page="{{ p }}">{{ p }}</a>
            </li>

            {% elif p == pagination.page - 3 or p == pagination.page + 3 %}
            <li class="page-item disabled">
                <span class="page-link">...</span>
            </li>
            {% endif %}
            {% endfor %}

            <li class="page-item {% if pagination.page == pagination.total_pages %}disabled{% endif %}">
                <a class="page-link" href="#" data-page="{{ pagination.page + 1 }}">
                    Next <i class="bi bi-chevron-right"></i>
                </a>
            </li>

        </ul>
    </nav>
</div>